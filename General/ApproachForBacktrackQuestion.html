<div class="discuss-markdown-container"><p>This structure might apply to many other backtracking questions, but here I am just going to demonstrate Subsets, Permutations, and Combination Sum.</p><p>
</p><p>Subsets : <a href="https://leetcode.com/problems/subsets/" rel="ugc">https://leetcode.com/problems/subsets/</a></p><p>
</p><pre><code><span class="hljs-keyword">public</span> List&lt;List&lt;Integer&gt;&gt; subsets(<span class="hljs-built_in">int</span>[] nums) {
    List&lt;List&lt;Integer&gt;&gt; list = <span class="hljs-keyword">new</span> ArrayList&lt;&gt;();
    Arrays.sort(nums);
    backtrack(list, <span class="hljs-keyword">new</span> ArrayList&lt;&gt;(), nums, <span class="hljs-number">0</span>);
    <span class="hljs-keyword">return</span> list;
}

<span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title">backtrack</span>(<span class="hljs-params">List&lt;List&lt;Integer&gt;&gt; list , List&lt;Integer&gt; tempList, <span class="hljs-built_in">int</span> [] nums, <span class="hljs-built_in">int</span> start</span>)</span>{
    list.<span class="hljs-keyword">add</span>(<span class="hljs-keyword">new</span> ArrayList&lt;&gt;(tempList));
    <span class="hljs-keyword">for</span>(<span class="hljs-built_in">int</span> i = start; i &lt; nums.length; i++){
        tempList.<span class="hljs-keyword">add</span>(nums[i]);
        backtrack(list, tempList, nums, i + <span class="hljs-number">1</span>);
        tempList.<span class="hljs-keyword">remove</span>(tempList.size() - <span class="hljs-number">1</span>);
    }
}
</code></pre>
<p></p><p>Subsets II (contains duplicates) : <a href="https://leetcode.com/problems/subsets-ii/" rel="ugc">https://leetcode.com/problems/subsets-ii/</a></p><p>
</p><pre><code><span class="hljs-keyword">public</span> List&lt;List&lt;Integer&gt;&gt; subsetsWithDup(<span class="hljs-built_in">int</span>[] nums) {
    List&lt;List&lt;Integer&gt;&gt; list = <span class="hljs-keyword">new</span> ArrayList&lt;&gt;();
    Arrays.sort(nums);
    backtrack(list, <span class="hljs-keyword">new</span> ArrayList&lt;&gt;(), nums, <span class="hljs-number">0</span>);
    <span class="hljs-keyword">return</span> list;
}

<span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title">backtrack</span>(<span class="hljs-params">List&lt;List&lt;Integer&gt;&gt; list, List&lt;Integer&gt; tempList, <span class="hljs-built_in">int</span> [] nums, <span class="hljs-built_in">int</span> start</span>)</span>{
    list.<span class="hljs-keyword">add</span>(<span class="hljs-keyword">new</span> ArrayList&lt;&gt;(tempList));
    <span class="hljs-keyword">for</span>(<span class="hljs-built_in">int</span> i = start; i &lt; nums.length; i++){
        <span class="hljs-keyword">if</span>(i &gt; start &amp;&amp; nums[i] == nums[i<span class="hljs-number">-1</span>]) <span class="hljs-keyword">continue</span>; <span class="hljs-comment">// skip duplicates</span>
        tempList.<span class="hljs-keyword">add</span>(nums[i]);
        backtrack(list, tempList, nums, i + <span class="hljs-number">1</span>);
        tempList.<span class="hljs-keyword">remove</span>(tempList.size() - <span class="hljs-number">1</span>);
    }
} 
</code></pre>
<hr>
<p></p><p>Permutations : <a href="https://leetcode.com/problems/permutations/" rel="ugc">https://leetcode.com/problems/permutations/</a></p><p>
</p><pre><code><span class="hljs-keyword">public</span> List&lt;List&lt;Integer&gt;&gt; permute(<span class="hljs-built_in">int</span>[] nums) {
   List&lt;List&lt;Integer&gt;&gt; list = <span class="hljs-keyword">new</span> ArrayList&lt;&gt;();
   <span class="hljs-comment">// Arrays.sort(nums); // not necessary</span>
   backtrack(list, <span class="hljs-keyword">new</span> ArrayList&lt;&gt;(), nums);
   <span class="hljs-keyword">return</span> list;
}

<span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title">backtrack</span>(<span class="hljs-params">List&lt;List&lt;Integer&gt;&gt; list, List&lt;Integer&gt; tempList, <span class="hljs-built_in">int</span> [] nums</span>)</span>{
   <span class="hljs-keyword">if</span>(tempList.size() == nums.length){
      list.<span class="hljs-keyword">add</span>(<span class="hljs-keyword">new</span> ArrayList&lt;&gt;(tempList));
   } <span class="hljs-keyword">else</span>{
      <span class="hljs-keyword">for</span>(<span class="hljs-built_in">int</span> i = <span class="hljs-number">0</span>; i &lt; nums.length; i++){ 
         <span class="hljs-keyword">if</span>(tempList.contains(nums[i])) <span class="hljs-keyword">continue</span>; <span class="hljs-comment">// element already exists, skip</span>
         tempList.<span class="hljs-keyword">add</span>(nums[i]);
         backtrack(list, tempList, nums);
         tempList.<span class="hljs-keyword">remove</span>(tempList.size() - <span class="hljs-number">1</span>);
      }
   }
} 
</code></pre>
<p></p><p>Permutations II (contains duplicates) : <a href="https://leetcode.com/problems/permutations-ii/" rel="ugc">https://leetcode.com/problems/permutations-ii/</a></p><p>
</p><pre><code><span class="hljs-keyword">public</span> <span class="hljs-keyword">List</span>&lt;<span class="hljs-keyword">List</span>&lt;<span class="hljs-keyword">Integer</span>&gt;&gt; permuteUnique(<span class="hljs-keyword">int</span>[] nums) {
    <span class="hljs-keyword">List</span>&lt;<span class="hljs-keyword">List</span>&lt;<span class="hljs-keyword">Integer</span>&gt;&gt; <span class="hljs-keyword">list</span> = <span class="hljs-keyword">new</span> ArrayList&lt;&gt;();
    Arrays.sort(nums);
    backtrack(<span class="hljs-keyword">list</span>, <span class="hljs-keyword">new</span> ArrayList&lt;&gt;(), nums, <span class="hljs-keyword">new</span> <span class="hljs-keyword">boolean</span>[nums.length]);
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">list</span>;
}

<span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> backtrack(<span class="hljs-keyword">List</span>&lt;<span class="hljs-keyword">List</span>&lt;<span class="hljs-keyword">Integer</span>&gt;&gt; <span class="hljs-keyword">list</span>, <span class="hljs-keyword">List</span>&lt;<span class="hljs-keyword">Integer</span>&gt; tempList, <span class="hljs-keyword">int</span> [] nums, <span class="hljs-keyword">boolean</span> [] used){
    <span class="hljs-keyword">if</span>(tempList.size() == nums.length){
        <span class="hljs-keyword">list</span>.add(<span class="hljs-keyword">new</span> ArrayList&lt;&gt;(tempList));
    } <span class="hljs-keyword">else</span>{
        <span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; nums.length; i++){
            <span class="hljs-keyword">if</span>(used[i] || i &gt; <span class="hljs-number">0</span> &amp;&amp; nums[i] == nums[i<span class="hljs-number">-1</span>] &amp;&amp; !used[i - <span class="hljs-number">1</span>]) <span class="hljs-keyword">continue</span>;
            used[i] = <span class="hljs-literal">true</span>; 
            tempList.add(nums[i]);
            backtrack(<span class="hljs-keyword">list</span>, tempList, nums, used);
            used[i] = <span class="hljs-literal">false</span>; 
            tempList.remove(tempList.size() - <span class="hljs-number">1</span>);
        }
    }
}
</code></pre>
<hr>
<p></p><p>Combination Sum : <a href="https://leetcode.com/problems/combination-sum/" rel="ugc">https://leetcode.com/problems/combination-sum/</a></p><p>
</p><pre><code><span class="hljs-keyword">public</span> List&lt;List&lt;Integer&gt;&gt; combinationSum(<span class="hljs-built_in">int</span>[] nums, <span class="hljs-built_in">int</span> target) {
    List&lt;List&lt;Integer&gt;&gt; list = <span class="hljs-keyword">new</span> ArrayList&lt;&gt;();
    Arrays.sort(nums);
    backtrack(list, <span class="hljs-keyword">new</span> ArrayList&lt;&gt;(), nums, target, <span class="hljs-number">0</span>);
    <span class="hljs-keyword">return</span> list;
}

<span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title">backtrack</span>(<span class="hljs-params">List&lt;List&lt;Integer&gt;&gt; list, List&lt;Integer&gt; tempList, <span class="hljs-built_in">int</span> [] nums, <span class="hljs-built_in">int</span> remain, <span class="hljs-built_in">int</span> start</span>)</span>{
    <span class="hljs-keyword">if</span>(remain &lt; <span class="hljs-number">0</span>) <span class="hljs-keyword">return</span>;
    <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(remain == <span class="hljs-number">0</span>) list.<span class="hljs-keyword">add</span>(<span class="hljs-keyword">new</span> ArrayList&lt;&gt;(tempList));
    <span class="hljs-keyword">else</span>{ 
        <span class="hljs-keyword">for</span>(<span class="hljs-built_in">int</span> i = start; i &lt; nums.length; i++){
            tempList.<span class="hljs-keyword">add</span>(nums[i]);
            backtrack(list, tempList, nums, remain - nums[i], i); <span class="hljs-comment">// not i + 1 because we can reuse same elements</span>
            tempList.<span class="hljs-keyword">remove</span>(tempList.size() - <span class="hljs-number">1</span>);
        }
    }
}
</code></pre>
<p></p><p>Combination Sum II (can't reuse same element) : <a href="https://leetcode.com/problems/combination-sum-ii/" rel="ugc">https://leetcode.com/problems/combination-sum-ii/</a></p><p>
</p><pre><code><span class="hljs-keyword">public</span> List&lt;List&lt;Integer&gt;&gt; combinationSum2(<span class="hljs-built_in">int</span>[] nums, <span class="hljs-built_in">int</span> target) {
    List&lt;List&lt;Integer&gt;&gt; list = <span class="hljs-keyword">new</span> ArrayList&lt;&gt;();
    Arrays.sort(nums);
    backtrack(list, <span class="hljs-keyword">new</span> ArrayList&lt;&gt;(), nums, target, <span class="hljs-number">0</span>);
    <span class="hljs-keyword">return</span> list;
    
}

<span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title">backtrack</span>(<span class="hljs-params">List&lt;List&lt;Integer&gt;&gt; list, List&lt;Integer&gt; tempList, <span class="hljs-built_in">int</span> [] nums, <span class="hljs-built_in">int</span> remain, <span class="hljs-built_in">int</span> start</span>)</span>{
    <span class="hljs-keyword">if</span>(remain &lt; <span class="hljs-number">0</span>) <span class="hljs-keyword">return</span>;
    <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(remain == <span class="hljs-number">0</span>) list.<span class="hljs-keyword">add</span>(<span class="hljs-keyword">new</span> ArrayList&lt;&gt;(tempList));
    <span class="hljs-keyword">else</span>{
        <span class="hljs-keyword">for</span>(<span class="hljs-built_in">int</span> i = start; i &lt; nums.length; i++){
            <span class="hljs-keyword">if</span>(i &gt; start &amp;&amp; nums[i] == nums[i<span class="hljs-number">-1</span>]) <span class="hljs-keyword">continue</span>; <span class="hljs-comment">// skip duplicates</span>
            tempList.<span class="hljs-keyword">add</span>(nums[i]);
            backtrack(list, tempList, nums, remain - nums[i], i + <span class="hljs-number">1</span>);
            tempList.<span class="hljs-keyword">remove</span>(tempList.size() - <span class="hljs-number">1</span>); 
        }
    }
} 
</code></pre>
<p></p><p>Palindrome Partitioning : <a href="https://leetcode.com/problems/palindrome-partitioning/" rel="ugc">https://leetcode.com/problems/palindrome-partitioning/</a></p><p>
</p><pre><code>public List&lt;List&lt;<span class="hljs-built_in">String</span>&gt;&gt; <span class="hljs-function"><span class="hljs-title">partition</span>(<span class="hljs-params"><span class="hljs-built_in">String</span> s</span>)</span> {
   List&lt;List&lt;<span class="hljs-built_in">String</span>&gt;&gt; list = <span class="hljs-keyword">new</span> ArrayList&lt;&gt;();
   backtrack(list, <span class="hljs-keyword">new</span> ArrayList&lt;&gt;(), s, <span class="hljs-number">0</span>);
   <span class="hljs-keyword">return</span> list;
}

public <span class="hljs-keyword">void</span> <span class="hljs-function"><span class="hljs-title">backtrack</span>(<span class="hljs-params">List&lt;List&lt;<span class="hljs-built_in">String</span>&gt;&gt; list, List&lt;<span class="hljs-built_in">String</span>&gt; tempList, <span class="hljs-built_in">String</span> s, int start</span>)</span>{
   <span class="hljs-keyword">if</span>(start == s.length())
      list.add(<span class="hljs-keyword">new</span> ArrayList&lt;&gt;(tempList));
   <span class="hljs-keyword">else</span>{
      <span class="hljs-keyword">for</span>(int i = start; i &lt; s.length(); i++){
         <span class="hljs-keyword">if</span>(isPalindrome(s, start, i)){
            tempList.add(s.substring(start, i + <span class="hljs-number">1</span>));
            backtrack(list, tempList, s, i + <span class="hljs-number">1</span>);
            tempList.remove(tempList.size() - <span class="hljs-number">1</span>);
         }
      }
   }
}

public boolean <span class="hljs-function"><span class="hljs-title">isPalindrome</span>(<span class="hljs-params"><span class="hljs-built_in">String</span> s, int low, int high</span>)</span>{
   <span class="hljs-keyword">while</span>(low &lt; high)
      <span class="hljs-keyword">if</span>(s.charAt(low++) != s.charAt(high--)) <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
   <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
} 
</code></pre><p></p></div>